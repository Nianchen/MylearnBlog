<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript 设计模式核⼼原理与应⽤实践 | Nianchen的小白之路</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/MylearnBlog/favicon.ico">
    <meta name="description" content="Nianchen的小白之路">
    
    <link rel="preload" href="/MylearnBlog/assets/css/0.styles.918ca8c1.css" as="style"><link rel="preload" href="/MylearnBlog/assets/js/app.fee106bf.js" as="script"><link rel="preload" href="/MylearnBlog/assets/js/2.e001ac39.js" as="script"><link rel="preload" href="/MylearnBlog/assets/js/13.0a348f7f.js" as="script"><link rel="prefetch" href="/MylearnBlog/assets/js/10.488ee377.js"><link rel="prefetch" href="/MylearnBlog/assets/js/11.2bec4570.js"><link rel="prefetch" href="/MylearnBlog/assets/js/12.8507f2f5.js"><link rel="prefetch" href="/MylearnBlog/assets/js/14.d6f99464.js"><link rel="prefetch" href="/MylearnBlog/assets/js/15.98986dcc.js"><link rel="prefetch" href="/MylearnBlog/assets/js/16.f2128aa6.js"><link rel="prefetch" href="/MylearnBlog/assets/js/17.3164e73b.js"><link rel="prefetch" href="/MylearnBlog/assets/js/18.b0cf4643.js"><link rel="prefetch" href="/MylearnBlog/assets/js/3.d58b02b9.js"><link rel="prefetch" href="/MylearnBlog/assets/js/4.f18bd959.js"><link rel="prefetch" href="/MylearnBlog/assets/js/5.50c2d115.js"><link rel="prefetch" href="/MylearnBlog/assets/js/6.0bea5b90.js"><link rel="prefetch" href="/MylearnBlog/assets/js/7.989f0155.js"><link rel="prefetch" href="/MylearnBlog/assets/js/8.92c66b8a.js"><link rel="prefetch" href="/MylearnBlog/assets/js/9.de1043a3.js">
    <link rel="stylesheet" href="/MylearnBlog/assets/css/0.styles.918ca8c1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/MylearnBlog/" class="home-link router-link-active"><!----> <span class="site-name">Nianchen的小白之路</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/MylearnBlog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MyGithub" class="dropdown-title"><span class="title">MyGithub</span> <span class="arrow down"></span></button> <button type="button" aria-label="MyGithub" class="mobile-dropdown-title"><span class="title">MyGithub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Nianchen" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/MylearnBlog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MyGithub" class="dropdown-title"><span class="title">MyGithub</span> <span class="arrow down"></span></button> <button type="button" aria-label="MyGithub" class="mobile-dropdown-title"><span class="title">MyGithub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Nianchen" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>入门知识系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/MylearnBlog/browser/browser.html" class="sidebar-link">浏览器原理</a></li><li><a href="/MylearnBlog/javascript/Javascript.html" class="sidebar-link">JavaScript入门</a></li><li><a href="/MylearnBlog/ES6入门/ES6.html" class="sidebar-link">ES6入门</a></li><li><a href="/MylearnBlog/深入系列/深入系列.html" class="sidebar-link">JavaScript深入系列</a></li><li><a href="/MylearnBlog/javascript/Javascript中的设计模式.html" class="active sidebar-link">JavaScript设计模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MylearnBlog/javascript/Javascript中的设计模式.html#javascript-设计模式核心原理与应用实践" class="sidebar-link">JavaScript 设计模式核⼼原理与应⽤实践</a></li><li class="sidebar-sub-header"><a href="/MylearnBlog/javascript/Javascript中的设计模式.html#构造器模式" class="sidebar-link">构造器模式</a></li><li class="sidebar-sub-header"><a href="/MylearnBlog/javascript/Javascript中的设计模式.html#单例模式" class="sidebar-link">单例模式</a></li><li class="sidebar-sub-header"><a href="/MylearnBlog/javascript/Javascript中的设计模式.html#原型设计模式" class="sidebar-link">原型设计模式</a></li><li class="sidebar-sub-header"><a href="/MylearnBlog/javascript/Javascript中的设计模式.html#装饰器模式" class="sidebar-link">装饰器模式</a></li><li class="sidebar-sub-header"><a href="/MylearnBlog/javascript/Javascript中的设计模式.html#适配器模式" class="sidebar-link">适配器模式</a></li><li class="sidebar-sub-header"><a href="/MylearnBlog/javascript/Javascript中的设计模式.html#代理模式" class="sidebar-link">代理模式</a></li><li class="sidebar-sub-header"><a href="/MylearnBlog/javascript/Javascript中的设计模式.html#策略模式" class="sidebar-link">策略模式</a></li><li class="sidebar-sub-header"><a href="/MylearnBlog/javascript/Javascript中的设计模式.html#观察者模式" class="sidebar-link">观察者模式</a></li><li class="sidebar-sub-header"><a href="/MylearnBlog/javascript/Javascript中的设计模式.html#使用观察者模式实现vue的响应原理" class="sidebar-link">使用观察者模式实现Vue的响应原理</a></li></ul></li><li><a href="/MylearnBlog/Vue2/Vue2.html" class="sidebar-link">Vue2</a></li><li><a href="/MylearnBlog/Typescript/Typescript.html" class="sidebar-link">Typescript入门</a></li><li><a href="/MylearnBlog/javascript/正则表达式.html" class="sidebar-link">正则表达式</a></li><li><a href="/MylearnBlog/计算机网络入门/计算机网络.html" class="sidebar-link">计算机网络入门</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>一些简单的面试题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/MylearnBlog/一些简单的面试题/面试相关js.html" class="sidebar-link">一些简单的面试题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>小工具系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/MylearnBlog/小工具系列/如何搭建自己的图床笔记.html" class="sidebar-link">如何在笔记中添加自己的图床</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="javascript-设计模式核心原理与应用实践"><a href="#javascript-设计模式核心原理与应用实践" class="header-anchor">#</a> <a href="https://juejin.cn/book/6844733790204461070" target="_blank" rel="noopener noreferrer">JavaScript 设计模式核⼼原理与应⽤实践<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <p>设计模式只是为了解决某些固定问题的通用解，就是为了解决问题而产生的工具，而不是一些晦涩的理论知识。只是因为软件设计原来越趋向于复杂，设计模式的核心思想是封装变化。把开发中遇到的变化影响最小化，灵活的在各种开发场景下完成开发任务。</p> <h2 id="构造器模式"><a href="#构造器模式" class="header-anchor">#</a> 构造器模式</h2> <p>虽然这个名字很吓人，但是日常开发中构造器模式无时无刻都在使用，比如我们需要创造不同员工，以及员工身上的属性，我们往往需要这么写</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
<span class="token punctuation">}</span>
<span class="token keyword">const</span> user1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span>
</code></pre></div><p>当然你也可以直接手写字面量，比如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> user2 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span>
<span class="token punctuation">}</span>
</code></pre></div><p>但是现在的情况是数据比较少，你可以通过书写字面量的形式把数据书写出来，如果后续的时间内，数据肯定是成千上万的，通过手写字面量就显得不太合理。所以就产生了构造器模式，通过构造器进行构造这些对象</p> <p>我们在前言中提到了，设计模式的核心是封装变化，我们从这个构造器中出发分析，哪些是<strong>不变</strong>的，哪些是<strong>变化</strong>的，首先不同的人的值肯定是不同的，这就是一个变化量，但是这些属性又恰恰是不同对象之间的共性，比如name，age这些共性，构造器模式就是封装了这些不会变化的共性，反而变化的值我们可以通过参数进行传递。</p> <h3 id="简单工厂模式"><a href="#简单工厂模式" class="header-anchor">#</a> 简单工厂模式</h3> <p>还是从思考变化出发，如果我们需要在这些基础的人身上添加一些职务工作属性呢，从不变的角度出发，不变的是职务，工作这些字段，变化的是这些字段的值，我们就需要再继续对这些不变化的部分进行进一步封装</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token parameter">name <span class="token punctuation">,</span> age<span class="token punctuation">,</span> career<span class="token punctuation">,</span> work</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
    <span class="token keyword">this</span><span class="token punctuation">.</span>career <span class="token operator">=</span> career 
    <span class="token keyword">this</span><span class="token punctuation">.</span>work <span class="token operator">=</span> work
<span class="token punctuation">}</span>
<span class="token comment">//这里是工厂的部分，通过对career职位的加工返回了一个具有相对应工作的对象</span>
<span class="token keyword">function</span> <span class="token function">Factory</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> career</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> work
    <span class="token keyword">switch</span><span class="token punctuation">(</span>career<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'coder'</span><span class="token operator">:</span>
            work <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token string">'写代码'</span><span class="token punctuation">,</span><span class="token string">'写系分'</span><span class="token punctuation">,</span> <span class="token string">'修Bug'</span><span class="token punctuation">]</span> 
            <span class="token keyword">break</span>
        <span class="token keyword">case</span> <span class="token string">'product manager'</span><span class="token operator">:</span>
            work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'订会议室'</span><span class="token punctuation">,</span> <span class="token string">'写PRD'</span><span class="token punctuation">,</span> <span class="token string">'催更'</span><span class="token punctuation">]</span>
            <span class="token keyword">break</span>
        <span class="token keyword">case</span> <span class="token string">'boss'</span><span class="token operator">:</span>
            work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'喝茶'</span><span class="token punctuation">,</span> <span class="token string">'看报'</span><span class="token punctuation">,</span> <span class="token string">'见客户'</span><span class="token punctuation">]</span>
        <span class="token keyword">case</span> <span class="token string">'xxx'</span><span class="token operator">:</span>
            <span class="token comment">// 其它工种的职责分配</span>
            <span class="token operator">...</span>
            
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> career<span class="token punctuation">,</span> work<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//工厂模式的最终目的，就是我们在进行一些对象的构建过程中只需要调用工厂函数并进行无脑传参就可以进一步生成对应的对象数据。</span>
</code></pre></div><p>这里可能有一些疑问，为什么work不属于共性的一部分？因为work是有career所决定的，并不需要外部传参决定，应该由career从而决定他需要进行哪些工作。</p> <h2 id="单例模式"><a href="#单例模式" class="header-anchor">#</a> 单例模式</h2> <p>保证一个类仅有一个实例，并且提供一个可以全局访问的点，这种模式就叫做单例模式，比如Vuex的实现方法，全局都可以调用但是只有一个Vuex实例，也不会出现数据的浅拷贝问题。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">SingleDog</span><span class="token punctuation">{</span>
    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;我是单例对象&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s1 <span class="token operator">===</span> s2 <span class="token boolean">false</span>
<span class="token comment">//我们正常通过new关键字建立两个不同的实例对象，这两个实例对象本身肯定不同</span>
<span class="token comment">//但是在单例模式中，我们想要两次建立的对象都指向同一个对象。</span>
<span class="token keyword">class</span> <span class="token class-name">SingleDog</span> <span class="token punctuation">{</span>
    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我是一个单例对象'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 判断是否已经new过1个实例</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>SingleDog<span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//instance这个属性可以判断这个对象是否被建立过</span>
            <span class="token comment">// 若这个唯一的实例不存在，那么先创建它</span>
            SingleDog<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 如果这个唯一的实例已经存在，则直接返回</span>
        <span class="token keyword">return</span> SingleDog<span class="token punctuation">.</span>instance
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> s1 <span class="token operator">=</span> SingleDog<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> s2 <span class="token operator">=</span> SingleDog<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// true</span>
s1 <span class="token operator">===</span> s2

</code></pre></div><h3 id="vuex中的单例模式"><a href="#vuex中的单例模式" class="header-anchor">#</a> Vuex中的单例模式</h3> <p>Vuex是Vue中的常见的状态管理工具，通过全局Store存储了应用的何怒都状态值，这个Stroe就是常见的单例模式，只存在一个store并且全局可调用
我们在这里不关注Vuex的具体使用，我们主要关注Vuex如何保证store的唯一性质，Vuex在<code>Vue.use()</code>的时候内部执行了依次install方法，这个方法类似于getinstance如果vuex实例已经存在就抛出错误，不存在就在vue上挂载这个属性。</p> <h2 id="原型设计模式"><a href="#原型设计模式" class="header-anchor">#</a> 原型设计模式</h2> <p>基本上就是JS原型链的东西。能清楚了解JS中原型链的整个流程就可以了</p> <h2 id="装饰器模式"><a href="#装饰器模式" class="header-anchor">#</a> 装饰器模式</h2> <p>再不修改原有对象的基础上，对对象进行包装拓展，让其拥有更多的功能，比如对于老功能，不去修改老功能中的代码，而是把老功能独立抽调出来，然后把新老两个独立的功能进行整合。这样就不违背，只添加不修改这个本质要求。</p> <p>在ES7中提供了装饰器的语法糖进行书写装饰器</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">classDecorator</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    target<span class="token punctuation">.</span>hasDecorator <span class="token operator">=</span> <span class="token boolean">true</span>
    	<span class="token keyword">return</span> target
<span class="token punctuation">}</span>
@classDecorator
<span class="token comment">//这里就代表了安装装饰器</span>
<span class="token keyword">class</span> <span class="token class-name">Button</span><span class="token punctuation">{</span>
	xxx
<span class="token punctuation">}</span>
<span class="token comment">//可以对整个类装饰，也可以对某些方法进行装饰</span>
</code></pre></div><h2 id="适配器模式"><a href="#适配器模式" class="header-anchor">#</a> 适配器模式</h2> <p>适配器模式通过<strong>把一个类的接口变换成客户端所期待的另一种接口</strong>，可以帮我们解决<strong>不兼容</strong>的问题。</p> <p>通过一个类的适配器，对传入的参数进一步分析适配，在决定传入的参数需要调用的是哪一种方案，最后返回方法，统一接口，统一出参，统一规则，通过适配器把不同的东西转化成了相同的东西。类如axios对ajax的高度封装。</p> <h2 id="代理模式"><a href="#代理模式" class="header-anchor">#</a> 代理模式</h2> <p>最直白的例子就是如何科学上网，正常的dns无法访问外网，但是通过代理服务器的中专以后，代理服务器返回了可以访问的结果。如果针对数据而言，就是访问一个数据的时候，其实访问的并不是数据本身，而是代理数据，通过这个代理可以实现一些进一步的操作。</p> <p>在ES6以后产出了专门负责代理的Proxy，Proxy也是vue3实现响应式原理的基础。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> girl <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span>xx<span class="token punctuation">,</span>
    <span class="token literal-property property">career</span><span class="token operator">:</span><span class="token string">&quot;teacher&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">phone</span><span class="token operator">:</span><span class="token string">''</span>
<span class="token punctuation">}</span>
<span class="token comment">//比如这是一个小姐姐的个人信息,但是这些网络上的信息肯定不是完全真实的</span>
<span class="token comment">//你肯定要付出一部分东西逐步解锁这些真实信息</span>

<span class="token comment">// 普通私密信息</span>
<span class="token keyword">const</span> baseInfo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'career'</span><span class="token punctuation">]</span>
<span class="token comment">// 最私密信息</span>
<span class="token keyword">const</span> privateInfo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'avatar'</span><span class="token punctuation">,</span> <span class="token string">'phone'</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token operator">...</span>，
    <span class="token literal-property property">isValidated</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">isVIP</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> MessageProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>girl<span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">girl<span class="token punctuation">,</span>key</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//在这里如果我们访问的是一些很私密的信息就可以做出提醒</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>isValidated <span class="token operator">&amp;&amp;</span> privateInfo<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>isVIP<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'只有VIP才可以查看该信息哦'</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//这样 用户想要访问一些私密属性就需要 开通VIP才能进行访问了。</span>
</code></pre></div><h2 id="策略模式"><a href="#策略模式" class="header-anchor">#</a> 策略模式</h2> <p>//就是让你的代码里不要出现一长串的if else，虽然讲道理确实能跑，但是违背了单一功能和开闭原则，每一次有新逻辑的加入都需要修改if else里的东西，而且容易让测试过来打人。</p> <p><img src="https://cdn.jsdelivr.net/gh/Nianchen/LearnImg/202211111708868.png" alt="image-20221111170801787"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//当价格类型为“预售价”时，满 100 - 20，不满 100 打 9 折</span>
<span class="token comment">//当价格类型为“大促价”时，满 100 - 30，不满 100 打 8 折</span>
<span class="token comment">//针对这种情况， if else很快就可以实现</span>
<span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span>Price</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">==</span> <span class="token string">'pre'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>Price <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> Price <span class="token operator">-</span> <span class="token number">20</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> Price <span class="token operator">*</span> <span class="token number">0.9</span>
    <span class="token punctuation">}</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'onSale'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span>
    <span class="token punctuation">}</span> 
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//很显然这种处理方式没有错，但是我们后序如果这个tag非常多，就会导致这个askPrice函数非常臃肿,而且需要在多个逻辑中寻找bug</span>

<span class="token comment">//第一版改造</span>
<span class="token keyword">function</span> <span class="token function">prePrice</span><span class="token punctuation">(</span><span class="token parameter">Price</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span>Price <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> Price <span class="token operator">-</span> <span class="token number">20</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> Price <span class="token operator">*</span> <span class="token number">0.9</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">onSalePrice</span><span class="token punctuation">(</span><span class="token parameter">Price</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span>
    <span class="token punctuation">}</span> 
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span>Price</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'pre'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">prePrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 处理大促价</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'onSale'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">onSalePrice</span><span class="token punctuation">(</span>originPrice<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//我们这样做就把每一种情况从原有的逻辑中拆分了出来，但是我们可以看到，askPrice种还是包含了很多if else我们只解决了抽取逻辑这一半的工作，而且后续新tag的开放还是得修改askPrice函数 不满足开闭原则</span>

<span class="token comment">//第二版</span>
<span class="token comment">// 定义一个询价处理器对象</span>
<span class="token keyword">const</span> priceProcessor <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">pre</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onSale</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">back</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>originPrice <span class="token operator">&gt;=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> originPrice <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> originPrice<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">fresh</span><span class="token punctuation">(</span><span class="token parameter">originPrice</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> originPrice <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">askPrice</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span>Price</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> priceProcessor<span class="token punctuation">[</span>tag<span class="token punctuation">]</span><span class="token punctuation">(</span>Price<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//这么处理 就把多个if 转换成了映射关系，每次修改新的需求就不要更改askPrice函数，保证了开闭原则。</span>
</code></pre></div><h2 id="观察者模式"><a href="#观察者模式" class="header-anchor">#</a> 观察者模式</h2> <p>通常在这个模式中，一个发布者往往对应着多个订阅者，比如如果你的leader需要把一个需求发送给一整个开发团队，这个开发团队往往包含了，前端，后端，测试等多个岗位，一般我们是不是在日常遇到这个情况，leader会给你拉一个群，然后把在群里通知你们。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//在上面这个场景中，leader就类似于发布者，你自身就属于订阅者</span>
<span class="token keyword">class</span> <span class="token class-name">Publisher</span><span class="token punctuation">{</span>
    <span class="token comment">//定义发布者 发布者负责拉群以及通知</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
       	<span class="token comment">//初始化订阅者队列</span>
    <span class="token punctuation">}</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//添加订阅者，也就是往群里拉人</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">remove</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//删除订阅者，从群里T人</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>observer<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>item <span class="token operator">==</span> observer<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
         <span class="token comment">//遍历找到对应订阅者然后删除</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//最重要的功能 通知你干活</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">foreach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
           observer<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//定义订阅者类</span>
<span class="token keyword">class</span> <span class="token class-name">Observer</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
    <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
    <span class="token comment">//为什么订阅者这么简单呢，因为订阅者从功能角度来说只能被添加以及被执行，比如你的leader你只能听从你的leader的安排以及派发工作</span>
<span class="token punctuation">}</span>
</code></pre></div><p>但是如果这时候 甲方的方案以及需求还不明确，你的leader需要等待这个需求文档，一旦这个需求文档准备完成就立马通知你们干活</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//基于上一段代码进行拓展实现</span>
<span class="token keyword">class</span> <span class="token class-name">PrdPublisher</span> <span class="token keyword">extends</span> <span class="token class-name">Publisher</span><span class="token punctuation">{</span>
      <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 初始化需求文档的状态</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token comment">// 韩梅梅还没有拉群，开发群目前为空</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'PrdPublisher created'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'PrdPublisher.getState invoked'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prdState
        <span class="token comment">//在这里返回需求文档的状态</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 该方法用于改变prdState的值</span>
    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'PrdPublisher.setState invoked'</span><span class="token punctuation">)</span>
        <span class="token comment">// prd的值发生改变</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> state
        <span class="token comment">// 需求文档变更，立刻通知所有开发者</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//相对应的 如果发布者需要关注这个需求文档，那么订阅者也需要接受这个需求文档</span>
<span class="token keyword">class</span> <span class="token class-name">DeveloperObeserver</span> <span class="token keyword">extends</span> <span class="token class-name">Observer</span><span class="token punctuation">{</span>
     <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 需求文档一开始还不存在，prd初始为空对象</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
         <span class="token comment">//也就是多关注了需求文档的状态</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DeveloperObserver created'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">updata</span><span class="token punctuation">(</span><span class="token parameter">publisher</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>prdState <span class="token operator">=</span> publisher<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">//这里就需要去询问需求文档的状态</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
       <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 获取需求文档</span>
        <span class="token keyword">const</span> prd <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prdState
        <span class="token comment">// 开始基于需求文档提供的信息搬砖。。。</span>
        <span class="token operator">...</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'996 begins...'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//接下来就是如果把这段代码转换成实际开发下的场景</span>
<span class="token keyword">const</span> BigLeader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrdPublisher</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//定义发布者</span>
<span class="token keyword">const</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeveloperObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token constant">B</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeveloperObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//定义需求文档</span>
<span class="token keyword">const</span> prd <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 具体的需求内容</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
BigLeader<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">A</span><span class="token punctuation">)</span>
BigLeader<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">B</span><span class="token punctuation">)</span>
BigLeader<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>prd<span class="token punctuation">)</span>
</code></pre></div><h2 id="使用观察者模式实现vue的响应原理"><a href="#使用观察者模式实现vue的响应原理" class="header-anchor">#</a> 使用观察者模式实现Vue的响应原理</h2> <p>观察者模式其实在平常的开发中非常常见，比如如何实现Vue数据的响应式原理，我们都知道在Vue的日常开发中，数据的改变会进一步影响页面的变化
<img src="https://cdn.jsdelivr.net/gh/Nianchen/LearnImg/202211132116254.png" alt="image-20221113211615149"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//实现Observer</span>
<span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/MylearnBlog/深入系列/深入系列.html" class="prev">
        JavaScript深入系列
      </a></span> <span class="next"><a href="/MylearnBlog/Vue2/Vue2.html">
        Vue2
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/MylearnBlog/assets/js/app.fee106bf.js" defer></script><script src="/MylearnBlog/assets/js/2.e001ac39.js" defer></script><script src="/MylearnBlog/assets/js/13.0a348f7f.js" defer></script>
  </body>
</html>
